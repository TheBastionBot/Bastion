const a165_0x3062=['recentUsers','cache','test','../utils/omnic','responseReaction','makeRequest','1bFqUYW','smallestNeighbor','map','thank\x20you','1ngmOjj','setTimeout','../models/Member','reply','keys','../utils/gamification','/chat/instant?message=','users','response','responseMessage','handleGamification','exec','handleLevelRoles','random','\x20Trigger','set','floor','stringify','send','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','exports','../utils/emojis','../utils/numbers','json','173EohTAV','Team','../models/Role','Level-up\x20Reward','ðŸ‘ðŸ»','getString','locale','IRIS','get','fetchApplication','findById','multiplier','discord.js','constructor','../utils/embeds','find','author','handleVotingChannels','282046nujkwJ','487649FQaoIc','owner','save','guild','info','mentions','trigger','language','user','content','gamification','handleInstantResponses','COLORS','5595ZFspbF','185578qTYgqn','Logger','../models/Trigger','displayAvatarURL','thanks','then','document','from','remove','success','Constants','@bastion/tesseract','experience','splice','error','level','enabled','parseEmoji','premiumSinceTimestamp','287360RKkJsp','member','catch','replace','14FyTTqW','handleDirectMessageRelay','parse','channel','handleKarma','handleTriggers','humanMessage','reaction','tag','ModuleManagerEvent','797702rnABRu','MAX_EXPERIENCE','bastion.name','filter','size','../models/TextChannel','has','generateEmbed','default','length','replaceMessageVariables','react','status','262752FmTMtX','push','includes','getConstant','client','_id','credit','roles','DEFAUL_CURRENCY_REWARD_MULTIPLIER','MAX_LEVEL'];const a165_0x2be6=function(_0x285e8e,_0xf74e1c){_0x285e8e=_0x285e8e-0xae;let _0xcfa1db=a165_0x3062[_0x285e8e];return _0xcfa1db;};const a165_0x1cfa09=a165_0x2be6;(function(_0x737cc,_0x458c40){const _0x2b1c21=a165_0x2be6;while(!![]){try{const _0x42fcd5=-parseInt(_0x2b1c21(0xbd))*-parseInt(_0x2b1c21(0xdd))+parseInt(_0x2b1c21(0xff))+-parseInt(_0x2b1c21(0x120))*-parseInt(_0x2b1c21(0xcf))+parseInt(_0x2b1c21(0x10c))+-parseInt(_0x2b1c21(0xd0))*-parseInt(_0x2b1c21(0x11c))+parseInt(_0x2b1c21(0xf1))+parseInt(_0x2b1c21(0xde))*-parseInt(_0x2b1c21(0xf5));if(_0x42fcd5===_0x458c40)break;else _0x737cc['push'](_0x737cc['shift']());}catch(_0x31c115){_0x737cc['push'](_0x737cc['shift']());}}}(a165_0x3062,0x76fb8));const a165_0x1fbf31=function(){let _0x34fe2c=!![];return function(_0x8de0d1,_0x3945ed){const _0x37d6a4=_0x34fe2c?function(){if(_0x3945ed){const _0x4852e7=_0x3945ed['apply'](_0x8de0d1,arguments);return _0x3945ed=null,_0x4852e7;}}:function(){};return _0x34fe2c=![],_0x37d6a4;};}(),a165_0x34411a=a165_0x1fbf31(this,function(){const _0x32a206=function(){const _0x68b43a=a165_0x2be6,_0x132419=_0x32a206[_0x68b43a(0xca)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x68b43a(0xca)](_0x68b43a(0xb8));return!_0x132419[_0x68b43a(0x118)](a165_0x34411a);};return _0x32a206();});a165_0x34411a();'use strict';const tesseract_1=require(a165_0x1cfa09(0xe9)),discord_js_1=require(a165_0x1cfa09(0xc9)),embeds=require(a165_0x1cfa09(0xcb)),emojis=require(a165_0x1cfa09(0xba)),gamification=require(a165_0x1cfa09(0x125)),numbers=require(a165_0x1cfa09(0xbb)),omnic=require(a165_0x1cfa09(0x119)),variables=require('../utils/variables'),Config_1=require('../models/Config'),Member_1=require(a165_0x1cfa09(0x122)),Role_1=require(a165_0x1cfa09(0xbf)),TextChannel_1=require(a165_0x1cfa09(0x104)),Trigger_1=require(a165_0x1cfa09(0xe0));module[a165_0x1cfa09(0xb9)]=class HumanMessageEvent extends tesseract_1[a165_0x1cfa09(0xfe)]{constructor(){const _0x6481d2=a165_0x1cfa09;super(_0x6481d2(0xfb)),this['handleLevelRoles']=async(_0x7fe96e,_0x1095f6)=>{const _0x30aea7=_0x6481d2,_0x3badcf=await Role_1['default'][_0x30aea7(0xcc)]({'guild':_0x7fe96e[_0x30aea7(0xd3)]['id'],'level':{'$exists':!![],'$ne':null}});if(!_0x3badcf||!_0x3badcf[_0x30aea7(0x108)])return;const _0x3d799b=numbers[_0x30aea7(0x11d)](_0x1095f6,_0x3badcf['map'](_0xb80394=>_0xb80394[_0x30aea7(0xed)])),_0x2f32f8=_0x3badcf[_0x30aea7(0x102)](_0x211b0c=>_0x211b0c[_0x30aea7(0xed)]!==_0x3d799b&&_0x7fe96e['guild'][_0x30aea7(0x113)]['cache'][_0x30aea7(0x105)](_0x211b0c[_0x30aea7(0x111)])),_0x27c807=_0x3badcf[_0x30aea7(0x102)](_0x33d627=>_0x33d627[_0x30aea7(0xed)]===_0x3d799b&&_0x7fe96e[_0x30aea7(0xd3)]['roles'][_0x30aea7(0x117)][_0x30aea7(0x105)](_0x33d627[_0x30aea7(0x111)]));_0x27c807['length']&&(await _0x7fe96e[_0x30aea7(0xf2)]['roles']['add'](_0x27c807[_0x30aea7(0x11e)](_0x4903b4=>_0x4903b4['_id'])),await _0x7fe96e[_0x30aea7(0xf2)][_0x30aea7(0x113)][_0x30aea7(0xe6)](_0x2f32f8['map'](_0x2a7101=>_0x2a7101[_0x30aea7(0x111)])));},this['handleGamification']=async _0x2fc5aa=>{const _0x386bd3=_0x6481d2,_0x5d69c0=this['recentUsers'][_0x386bd3(0xc5)](_0x2fc5aa['guild']['id'])||[];if(_0x5d69c0[_0x386bd3(0x10e)](_0x2fc5aa['author']['id']))return;const _0x16509a=_0x2fc5aa[_0x386bd3(0x110)],_0x43db93=_0x2fc5aa[_0x386bd3(0xd3)],_0x491b3f=_0x2fc5aa[_0x386bd3(0xf2)];if(!_0x43db93['document'][_0x386bd3(0xda)]||!_0x43db93[_0x386bd3(0xe4)][_0x386bd3(0xda)][_0x386bd3(0xee)])return;if(_0x491b3f[_0x386bd3(0xe4)]['level']>=gamification[_0x386bd3(0x115)]||_0x491b3f[_0x386bd3(0xe4)][_0x386bd3(0xea)]>=gamification[_0x386bd3(0x100)](_0x43db93[_0x386bd3(0xe4)][_0x386bd3(0xda)][_0x386bd3(0xc8)]))return;_0x491b3f[_0x386bd3(0xe4)][_0x386bd3(0xea)]=_0x491b3f[_0x386bd3(0xf0)]?_0x491b3f[_0x386bd3(0xe4)][_0x386bd3(0xea)]+0x2:_0x491b3f[_0x386bd3(0xe4)]['experience']+0x1;const _0x4e8a5a=gamification['computeLevel'](_0x491b3f[_0x386bd3(0xe4)][_0x386bd3(0xea)],_0x43db93[_0x386bd3(0xe4)]['gamification']['multiplier']);_0x4e8a5a>_0x491b3f[_0x386bd3(0xe4)][_0x386bd3(0xed)]&&(await _0x491b3f[_0x386bd3(0x112)](_0x4e8a5a*gamification[_0x386bd3(0x114)],_0x386bd3(0xc0),_0x491b3f[_0x386bd3(0xe4)]),_0x43db93['document'][_0x386bd3(0xda)]['messages']&&_0x2fc5aa[_0x386bd3(0xf8)]['send']({'embed':{'color':tesseract_1[_0x386bd3(0xe8)]['COLORS'][_0x386bd3(0xc4)],'fields':[{'name':'LEVELED\x20UP!','value':_0x16509a['locale'][_0x386bd3(0xc2)](_0x43db93[_0x386bd3(0xe4)][_0x386bd3(0xd7)],_0x386bd3(0xd4),'levelUp',_0x2fc5aa['author'][_0x386bd3(0xfd)],_0x4e8a5a)}]}})[_0x386bd3(0xf3)](()=>{}),this[_0x386bd3(0xb1)](_0x2fc5aa,_0x4e8a5a)[_0x386bd3(0xf3)](tesseract_1['Logger'][_0x386bd3(0xec)])),_0x491b3f[_0x386bd3(0xe4)][_0x386bd3(0xed)]=_0x4e8a5a,await _0x491b3f['document'][_0x386bd3(0xd2)](),_0x5d69c0[_0x386bd3(0x10d)](_0x2fc5aa[_0x386bd3(0xcd)]['id']),this[_0x386bd3(0x116)][_0x386bd3(0xb4)](_0x2fc5aa['guild']['id'],_0x5d69c0),_0x2fc5aa[_0x386bd3(0x110)][_0x386bd3(0x121)](()=>{const _0x394e78=_0x386bd3,_0x3fed0c=this[_0x394e78(0x116)][_0x394e78(0xc5)](_0x2fc5aa[_0x394e78(0xd3)]['id']);_0x3fed0c[_0x394e78(0xeb)](_0x3fed0c['indexOf'](_0x2fc5aa['author']['id']),0x1),this[_0x394e78(0x116)][_0x394e78(0xb4)](_0x2fc5aa[_0x394e78(0xd3)]['id'],_0x3fed0c);},0x32c8);},this[_0x6481d2(0xfa)]=async _0x5835e0=>{const _0x46b3dd=_0x6481d2;if(!_0x5835e0[_0x46b3dd(0xd9)])return;const _0x332dff=await Trigger_1[_0x46b3dd(0x107)][_0x46b3dd(0xcc)]({'guild':_0x5835e0[_0x46b3dd(0xd3)]['id']}),_0x148781=[],_0x158303=[];for(const _0xf6125 of _0x332dff){const _0x114066=new RegExp(_0xf6125[_0x46b3dd(0xd6)]['replace'](/\?/g,'.')[_0x46b3dd(0xf4)](/\*+/g,'.*'),'ig');if(!_0x114066['test'](_0x5835e0[_0x46b3dd(0xd9)]))continue;_0xf6125['responseMessage']&&_0x148781['push'](_0xf6125[_0x46b3dd(0xae)]);if(_0xf6125[_0x46b3dd(0x11a)]){const _0x1149f7=emojis[_0x46b3dd(0xef)](_0xf6125['responseReaction']);_0x1149f7&&_0x158303[_0x46b3dd(0x10d)](_0x1149f7[_0x46b3dd(0xfc)]);}}_0x148781['length']&&_0x5835e0['channel'][_0x46b3dd(0xb7)]({'embed':{...embeds[_0x46b3dd(0x106)](JSON[_0x46b3dd(0xf7)](variables[_0x46b3dd(0x109)](JSON[_0x46b3dd(0xb6)](_0x148781[Math[_0x46b3dd(0xb5)](Math[_0x46b3dd(0xb2)]()*_0x148781[_0x46b3dd(0x108)])]),_0x5835e0))),'footer':{'text':_0x5835e0[_0x46b3dd(0x110)][_0x46b3dd(0xc3)][_0x46b3dd(0x10f)](_0x46b3dd(0x101))+_0x46b3dd(0xb3)}}})[_0x46b3dd(0xf3)](tesseract_1[_0x46b3dd(0xdf)]['error']),_0x158303[_0x46b3dd(0x108)]&&_0x5835e0[_0x46b3dd(0x10a)](_0x158303[Math[_0x46b3dd(0xb5)](Math[_0x46b3dd(0xb2)]()*_0x158303[_0x46b3dd(0x108)])])[_0x46b3dd(0xf3)](tesseract_1[_0x46b3dd(0xdf)]['error']);},this[_0x6481d2(0xce)]=async _0x2dc2b2=>{const _0x1ebd96=_0x6481d2,_0x2b761a=await TextChannel_1['default']['findOne']({'_id':_0x2dc2b2[_0x1ebd96(0xf8)]['id'],'voting':!![]});if(!_0x2b761a)return;_0x2dc2b2[_0x1ebd96(0x10a)]('ðŸ‘')['catch'](()=>{}),_0x2dc2b2[_0x1ebd96(0x10a)]('ðŸ‘Ž')['catch'](()=>{});},this[_0x6481d2(0xf9)]=async _0x251f0d=>{const _0x116ac2=_0x6481d2;if(!_0x251f0d[_0x116ac2(0xd9)])return;if(!_0x251f0d[_0x116ac2(0xd3)][_0x116ac2(0xe4)][_0x116ac2(0xda)]||!_0x251f0d[_0x116ac2(0xd3)][_0x116ac2(0xe4)][_0x116ac2(0xda)][_0x116ac2(0xee)])return;if((_0x251f0d[_0x116ac2(0xd9)]['toLowerCase']()['includes'](_0x116ac2(0xe2))||_0x251f0d[_0x116ac2(0xd9)]['toLowerCase']()['includes'](_0x116ac2(0x11f)))&&_0x251f0d[_0x116ac2(0xd5)]['users']&&_0x251f0d[_0x116ac2(0xd5)][_0x116ac2(0x127)][_0x116ac2(0x103)]){const _0x1f45f1=Array[_0x116ac2(0xe5)](_0x251f0d[_0x116ac2(0xd5)]['users'][_0x116ac2(0x124)]())[_0x116ac2(0x102)](_0x180f78=>_0x180f78!==_0x251f0d[_0x116ac2(0xf2)]['id']);await Member_1[_0x116ac2(0x107)]['updateMany']({'user':{'$in':_0x1f45f1},'guild':_0x251f0d['guild']['id']},{'$inc':{'karma':0x1}}),_0x251f0d['react'](_0x116ac2(0xc1))['catch'](()=>{});}},this[_0x6481d2(0xdb)]=async _0x627ba1=>{const _0x47feda=_0x6481d2;if(!_0x627ba1[_0x47feda(0xd9)])return;const _0x134f3c=await omnic[_0x47feda(0x11b)](_0x47feda(0x126)+encodeURIComponent(_0x627ba1['content']))[_0x47feda(0xe3)](_0x399741=>_0x399741[_0x47feda(0xbc)]());if(_0x134f3c[_0x47feda(0x10b)]!==_0x47feda(0xe7))return;const _0x4240a9=_0x134f3c['response'][_0x47feda(0x123)]instanceof Array?_0x134f3c['response'][_0x47feda(0x123)]:[_0x134f3c[_0x47feda(0x128)][_0x47feda(0x123)]];for(const _0xfe0493 of _0x4240a9){await _0x627ba1[_0x47feda(0xf8)]['send'](_0xfe0493)['catch'](()=>{});}},this[_0x6481d2(0xf6)]=async _0x25f01a=>{const _0x15850f=_0x6481d2,_0x7a7e60=await Config_1['default'][_0x15850f(0xc7)](_0x25f01a['client'][_0x15850f(0xd8)]['id']);if(_0x7a7e60['relayDirectMessages']&&_0x25f01a[_0x15850f(0xd9)]){const _0x4d9a95=await _0x25f01a['client'][_0x15850f(0xc6)](),_0x28adbe=_0x4d9a95['owner']instanceof discord_js_1[_0x15850f(0xbe)]?_0x4d9a95[_0x15850f(0xd1)][_0x15850f(0xd1)][_0x15850f(0xd8)]:_0x4d9a95[_0x15850f(0xd1)];if(_0x25f01a['author']['id']===_0x28adbe['id'])return;const _0x2cae86=await _0x28adbe['createDM']();await _0x2cae86[_0x15850f(0xb7)]({'embed':{'color':tesseract_1[_0x15850f(0xe8)][_0x15850f(0xdc)][_0x15850f(0xc4)],'author':{'name':_0x25f01a[_0x15850f(0xcd)][_0x15850f(0xfd)],'iconURL':_0x25f01a[_0x15850f(0xcd)][_0x15850f(0xe1)]({'dynamic':!![],'size':0x40})},'description':_0x25f01a['content'],'footer':{'text':_0x25f01a['author']['id']}}});}},this[_0x6481d2(0xb0)]=async _0x5e87b4=>{const _0x1c91f2=_0x6481d2;_0x5e87b4['guild']?(this[_0x1c91f2(0xaf)](_0x5e87b4)[_0x1c91f2(0xf3)](()=>{}),this[_0x1c91f2(0xfa)](_0x5e87b4)[_0x1c91f2(0xf3)](()=>{}),this[_0x1c91f2(0xf9)](_0x5e87b4)[_0x1c91f2(0xf3)](tesseract_1[_0x1c91f2(0xdf)][_0x1c91f2(0xec)]),this[_0x1c91f2(0xce)](_0x5e87b4)[_0x1c91f2(0xf3)](()=>{})):(this[_0x1c91f2(0xdb)](_0x5e87b4)[_0x1c91f2(0xf3)](()=>{}),this[_0x1c91f2(0xf6)](_0x5e87b4)[_0x1c91f2(0xf3)](()=>{}));},this[_0x6481d2(0x116)]=new Map();}};