const a164_0x5180=['MAX_EXPERIENCE','test','reply','parseEmoji','levelUp','updateMany','../models/Member','handleVotingChannels','messages','../models/Trigger','mentions','makeRequest','locale','LEVELED\x20UP!','channel','../utils/numbers','gamification','roles','content','exec','Team','catch','toLowerCase','success','tag','level','../utils/gamification','IRIS','_id','../utils/embeds','setTimeout','default','multiplier','findOne','length','fetchApplication','set','user','../models/TextChannel','humanMessage','Logger','document','react','random','then','client','json','keys','recentUsers','thanks','splice','stringify','cache','guild','createDM','author','ModuleManagerEvent','../utils/omnic','filter','bastion.name','return\x20/\x22\x20+\x20this\x20+\x20\x22/','status','enabled','responseMessage','map','handleTriggers','response','smallestNeighbor','experience','floor','handleLevelRoles','exports','trigger','parse','MAX_LEVEL','discord.js','handleKarma','credit','Constants','DEFAUL_CURRENCY_REWARD_MULTIPLIER','get','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','users','/chat/instant?message=','includes','findById','has','replace','handleInstantResponses','handleGamification','Level-up\x20Reward','getString','indexOf','from','error','apply','relayDirectMessages','member','\x20Trigger','responseReaction','COLORS','owner','premiumSinceTimestamp','generateEmbed','find','send','@bastion/tesseract'];(function(_0x5d4025,_0x252c4f){const _0x518038=function(_0x5839e1){while(--_0x5839e1){_0x5d4025['push'](_0x5d4025['shift']());}},_0x5caf83=function(){const _0x5cd1af={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x526835,_0x514ba2,_0x353da4,_0x23f90f){_0x23f90f=_0x23f90f||{};let _0xab4ac6=_0x514ba2+'='+_0x353da4,_0x1697d6=0x0;for(let _0x221a7f=0x0,_0x29a8a7=_0x526835['length'];_0x221a7f<_0x29a8a7;_0x221a7f++){const _0x4c8a38=_0x526835[_0x221a7f];_0xab4ac6+=';\x20'+_0x4c8a38;const _0x2b241a=_0x526835[_0x4c8a38];_0x526835['push'](_0x2b241a),_0x29a8a7=_0x526835['length'],_0x2b241a!==!![]&&(_0xab4ac6+='='+_0x2b241a);}_0x23f90f['cookie']=_0xab4ac6;},'removeCookie':function(){return'dev';},'getCookie':function(_0xaa73f3,_0x57fb4c){_0xaa73f3=_0xaa73f3||function(_0x296e4c){return _0x296e4c;};const _0x105072=_0xaa73f3(new RegExp('(?:^|;\x20)'+_0x57fb4c['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x11570c=function(_0x46437e,_0x17c376){_0x46437e(++_0x17c376);};return _0x11570c(_0x518038,_0x252c4f),_0x105072?decodeURIComponent(_0x105072[0x1]):undefined;}},_0xe46ca0=function(){const _0x565b65=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x565b65['test'](_0x5cd1af['removeCookie']['toString']());};_0x5cd1af['updateCookie']=_0xe46ca0;let _0x4f21e7='';const _0x95f73a=_0x5cd1af['updateCookie']();if(!_0x95f73a)_0x5cd1af['setCookie'](['*'],'counter',0x1);else _0x95f73a?_0x4f21e7=_0x5cd1af['getCookie'](null,'counter'):_0x5cd1af['removeCookie']();};_0x5caf83();}(a164_0x5180,0x1ac));const a164_0x5caf=function(_0x5d4025,_0x252c4f){_0x5d4025=_0x5d4025-0xed;let _0x518038=a164_0x5180[_0x5d4025];return _0x518038;};const a164_0x467297=a164_0x5caf,a164_0xe46ca0=function(){let _0x95f73a=!![];return function(_0x526835,_0x514ba2){const _0x353da4=_0x95f73a?function(){const _0x5436fc=a164_0x5caf;if(_0x514ba2){const _0x23f90f=_0x514ba2[_0x5436fc(0x14c)](_0x526835,arguments);return _0x514ba2=null,_0x23f90f;}}:function(){};return _0x95f73a=![],_0x353da4;};}(),a164_0x5cd1af=a164_0xe46ca0(this,function(){const _0xab4ac6=function(){const _0x32a30d=a164_0x5caf,_0x1697d6=_0xab4ac6['constructor'](_0x32a30d(0x129))()['constructor'](_0x32a30d(0x13e));return!_0x1697d6[_0x32a30d(0xee)](a164_0x5cd1af);};return _0xab4ac6();});a164_0x5cd1af();'use strict';const tesseract_1=require(a164_0x467297(0x157)),discord_js_1=require(a164_0x467297(0x138)),embeds=require(a164_0x467297(0x10a)),emojis=require('../utils/emojis'),gamification=require(a164_0x467297(0x107)),numbers=require(a164_0x467297(0xfc)),omnic=require(a164_0x467297(0x126)),variables=require('../utils/variables'),Config_1=require('../models/Config'),Member_1=require(a164_0x467297(0xf3)),Role_1=require('../models/Role'),TextChannel_1=require(a164_0x467297(0x113)),Trigger_1=require(a164_0x467297(0xf6));module[a164_0x467297(0x134)]=class HumanMessageEvent extends tesseract_1[a164_0x467297(0x125)]{constructor(){const _0x22854e=a164_0x467297;super(_0x22854e(0x114)),this[_0x22854e(0x133)]=async(_0x221a7f,_0x29a8a7)=>{const _0x24ecab=_0x22854e,_0x4c8a38=await Role_1['default']['find']({'guild':_0x221a7f[_0x24ecab(0x122)]['id'],'level':{'$exists':!![],'$ne':null}});if(!_0x4c8a38||!_0x4c8a38[_0x24ecab(0x10f)])return;const _0x2b241a=numbers[_0x24ecab(0x130)](_0x29a8a7,_0x4c8a38[_0x24ecab(0x12d)](_0x105072=>_0x105072[_0x24ecab(0x106)])),_0xaa73f3=_0x4c8a38['filter'](_0x11570c=>_0x11570c[_0x24ecab(0x106)]!==_0x2b241a&&_0x221a7f[_0x24ecab(0x122)][_0x24ecab(0xfe)][_0x24ecab(0x121)][_0x24ecab(0x143)](_0x11570c[_0x24ecab(0x109)])),_0x57fb4c=_0x4c8a38[_0x24ecab(0x127)](_0x296e4c=>_0x296e4c[_0x24ecab(0x106)]===_0x2b241a&&_0x221a7f[_0x24ecab(0x122)]['roles'][_0x24ecab(0x121)][_0x24ecab(0x143)](_0x296e4c[_0x24ecab(0x109)]));_0x57fb4c['length']&&(await _0x221a7f[_0x24ecab(0x14e)]['roles']['add'](_0x57fb4c[_0x24ecab(0x12d)](_0x46437e=>_0x46437e['_id'])),await _0x221a7f[_0x24ecab(0x14e)][_0x24ecab(0xfe)]['remove'](_0xaa73f3[_0x24ecab(0x12d)](_0x17c376=>_0x17c376[_0x24ecab(0x109)])));},this[_0x22854e(0x146)]=async _0x565b65=>{const _0x328934=_0x22854e,_0x2bbf96=this[_0x328934(0x11d)][_0x328934(0x13d)](_0x565b65[_0x328934(0x122)]['id'])||[];if(_0x2bbf96[_0x328934(0x141)](_0x565b65[_0x328934(0x124)]['id']))return;const _0xe5dc6d=_0x565b65[_0x328934(0x11a)],_0x235b80=_0x565b65[_0x328934(0x122)],_0x209f60=_0x565b65[_0x328934(0x14e)];if(!_0x235b80[_0x328934(0x116)]['gamification']||!_0x235b80[_0x328934(0x116)][_0x328934(0xfd)][_0x328934(0x12b)])return;if(_0x209f60['document']['level']>=gamification[_0x328934(0x137)]||_0x209f60['document']['experience']>=gamification[_0x328934(0xed)](_0x235b80[_0x328934(0x116)][_0x328934(0xfd)]['multiplier']))return;_0x209f60[_0x328934(0x116)][_0x328934(0x131)]=_0x209f60[_0x328934(0x153)]?_0x209f60[_0x328934(0x116)][_0x328934(0x131)]+0x2:_0x209f60[_0x328934(0x116)][_0x328934(0x131)]+0x1;const _0x2ebf7c=gamification['computeLevel'](_0x209f60[_0x328934(0x116)][_0x328934(0x131)],_0x235b80['document']['gamification'][_0x328934(0x10d)]);_0x2ebf7c>_0x209f60[_0x328934(0x116)][_0x328934(0x106)]&&(await _0x209f60[_0x328934(0x13a)](_0x2ebf7c*gamification[_0x328934(0x13c)],_0x328934(0x147),_0x209f60['document']),_0x235b80[_0x328934(0x116)][_0x328934(0xfd)][_0x328934(0xf5)]&&_0x565b65['channel'][_0x328934(0x156)]({'embed':{'color':tesseract_1[_0x328934(0x13b)][_0x328934(0x151)]['IRIS'],'fields':[{'name':_0x328934(0xfa),'value':_0xe5dc6d['locale'][_0x328934(0x148)](_0x235b80[_0x328934(0x116)]['language'],'info',_0x328934(0xf1),_0x565b65[_0x328934(0x124)][_0x328934(0x105)],_0x2ebf7c)}]}})[_0x328934(0x102)](()=>{}),this[_0x328934(0x133)](_0x565b65,_0x209f60[_0x328934(0x116)]['level'])[_0x328934(0x102)](tesseract_1[_0x328934(0x115)]['error'])),_0x209f60['document'][_0x328934(0x106)]=_0x2ebf7c,await _0x209f60[_0x328934(0x116)]['save'](),_0x2bbf96['push'](_0x565b65[_0x328934(0x124)]['id']),this['recentUsers'][_0x328934(0x111)](_0x565b65[_0x328934(0x122)]['id'],_0x2bbf96),_0x565b65[_0x328934(0x11a)][_0x328934(0x10b)](()=>{const _0x33bc0c=_0x328934,_0x5016bc=this[_0x33bc0c(0x11d)][_0x33bc0c(0x13d)](_0x565b65['guild']['id']);_0x5016bc[_0x33bc0c(0x11f)](_0x5016bc[_0x33bc0c(0x149)](_0x565b65['author']['id']),0x1),this[_0x33bc0c(0x11d)][_0x33bc0c(0x111)](_0x565b65[_0x33bc0c(0x122)]['id'],_0x5016bc);},0x32c8);},this[_0x22854e(0x12e)]=async _0x2fd5f7=>{const _0x2c09da=_0x22854e;if(!_0x2fd5f7[_0x2c09da(0xff)])return;const _0x46e303=await Trigger_1[_0x2c09da(0x10c)][_0x2c09da(0x155)]({'guild':_0x2fd5f7[_0x2c09da(0x122)]['id']}),_0x3fa2f7=[],_0x88e60d=[];for(const _0x2cf946 of _0x46e303){const _0x32fac8=new RegExp(_0x2cf946[_0x2c09da(0x135)][_0x2c09da(0x144)](/\?/g,'.')[_0x2c09da(0x144)](/\*+/g,'.*'),'ig');if(!_0x32fac8['test'](_0x2fd5f7[_0x2c09da(0xff)]))continue;_0x2cf946['responseMessage']&&_0x3fa2f7['push'](_0x2cf946[_0x2c09da(0x12c)]);if(_0x2cf946[_0x2c09da(0x150)]){const _0x4dcf7e=emojis[_0x2c09da(0xf0)](_0x2cf946[_0x2c09da(0x150)]);_0x4dcf7e&&_0x88e60d['push'](_0x4dcf7e['reaction']);}}_0x3fa2f7[_0x2c09da(0x10f)]&&_0x2fd5f7[_0x2c09da(0xfb)]['send']({'embed':{...embeds[_0x2c09da(0x154)](JSON[_0x2c09da(0x136)](variables['replaceMessageVariables'](JSON[_0x2c09da(0x120)](_0x3fa2f7[Math[_0x2c09da(0x132)](Math[_0x2c09da(0x118)]()*_0x3fa2f7[_0x2c09da(0x10f)])]),_0x2fd5f7))),'footer':{'text':_0x2fd5f7['client'][_0x2c09da(0xf9)]['getConstant'](_0x2c09da(0x128))+_0x2c09da(0x14f)}}})[_0x2c09da(0x102)](tesseract_1['Logger']['error']),_0x88e60d[_0x2c09da(0x10f)]&&_0x2fd5f7[_0x2c09da(0x117)](_0x88e60d[Math[_0x2c09da(0x132)](Math[_0x2c09da(0x118)]()*_0x88e60d[_0x2c09da(0x10f)])])[_0x2c09da(0x102)](tesseract_1[_0x2c09da(0x115)]['error']);},this['handleVotingChannels']=async _0x3def9e=>{const _0x318ee8=_0x22854e,_0x22e5f7=await TextChannel_1['default'][_0x318ee8(0x10e)]({'_id':_0x3def9e[_0x318ee8(0xfb)]['id'],'voting':!![]});if(!_0x22e5f7)return;_0x3def9e['react']('ðŸ‘')['catch'](()=>{}),_0x3def9e[_0x318ee8(0x117)]('ðŸ‘Ž')[_0x318ee8(0x102)](()=>{});},this[_0x22854e(0x139)]=async _0x4099b7=>{const _0x845f49=_0x22854e;if(!_0x4099b7['content'])return;if((_0x4099b7[_0x845f49(0xff)][_0x845f49(0x103)]()[_0x845f49(0x141)](_0x845f49(0x11e))||_0x4099b7[_0x845f49(0xff)][_0x845f49(0x103)]()['includes']('thank\x20you'))&&_0x4099b7[_0x845f49(0xf7)][_0x845f49(0x13f)]&&_0x4099b7[_0x845f49(0xf7)]['users']['size']){const _0x46f647=Array[_0x845f49(0x14a)](_0x4099b7[_0x845f49(0xf7)][_0x845f49(0x13f)][_0x845f49(0x11c)]())[_0x845f49(0x127)](_0x3af5c7=>_0x3af5c7!==_0x4099b7[_0x845f49(0x14e)]['id']);await Member_1[_0x845f49(0x10c)][_0x845f49(0xf2)]({'user':{'$in':_0x46f647},'guild':_0x4099b7[_0x845f49(0x122)]['id']},{'$inc':{'karma':0x1}}),_0x4099b7[_0x845f49(0x117)]('ðŸ‘ðŸ»')[_0x845f49(0x102)](()=>{});}},this[_0x22854e(0x145)]=async _0xb52b53=>{const _0x1693db=_0x22854e;if(!_0xb52b53[_0x1693db(0xff)])return;const _0x24d494=await omnic[_0x1693db(0xf8)](_0x1693db(0x140)+encodeURIComponent(_0xb52b53[_0x1693db(0xff)]))[_0x1693db(0x119)](_0x13f88e=>_0x13f88e[_0x1693db(0x11b)]());if(_0x24d494[_0x1693db(0x12a)]!==_0x1693db(0x104))return;const _0x51afbf=_0x24d494[_0x1693db(0x12f)][_0x1693db(0xef)]instanceof Array?_0x24d494[_0x1693db(0x12f)][_0x1693db(0xef)]:[_0x24d494[_0x1693db(0x12f)][_0x1693db(0xef)]];for(const _0x4c33fe of _0x51afbf){await _0xb52b53[_0x1693db(0xfb)][_0x1693db(0x156)](_0x4c33fe)[_0x1693db(0x102)](()=>{});}},this['handleDirectMessageRelay']=async _0x5baccd=>{const _0x390cee=_0x22854e,_0x36a5b5=await Config_1[_0x390cee(0x10c)][_0x390cee(0x142)](_0x5baccd[_0x390cee(0x11a)][_0x390cee(0x112)]['id']);if(_0x36a5b5[_0x390cee(0x14d)]&&_0x5baccd[_0x390cee(0xff)]){const _0x5d9627=await _0x5baccd['client'][_0x390cee(0x110)](),_0x2d642f=_0x5d9627[_0x390cee(0x152)]instanceof discord_js_1[_0x390cee(0x101)]?_0x5d9627[_0x390cee(0x152)][_0x390cee(0x152)][_0x390cee(0x112)]:_0x5d9627[_0x390cee(0x152)];if(_0x5baccd[_0x390cee(0x124)]['id']===_0x2d642f['id'])return;const _0x256a4f=await _0x2d642f[_0x390cee(0x123)]();await _0x256a4f[_0x390cee(0x156)]({'embed':{'color':tesseract_1[_0x390cee(0x13b)][_0x390cee(0x151)][_0x390cee(0x108)],'author':{'name':_0x5baccd['author'][_0x390cee(0x105)],'iconURL':_0x5baccd['author']['displayAvatarURL']({'dynamic':!![],'size':0x40})},'description':_0x5baccd[_0x390cee(0xff)],'footer':{'text':_0x5baccd['author']['id']}}});}},this[_0x22854e(0x100)]=async _0x2403df=>{const _0x282e35=_0x22854e;_0x2403df['guild']?(this['handleGamification'](_0x2403df)[_0x282e35(0x102)](()=>{}),this[_0x282e35(0x12e)](_0x2403df)[_0x282e35(0x102)](()=>{}),this['handleKarma'](_0x2403df)[_0x282e35(0x102)](tesseract_1[_0x282e35(0x115)][_0x282e35(0x14b)]),this[_0x282e35(0xf4)](_0x2403df)[_0x282e35(0x102)](()=>{})):(this[_0x282e35(0x145)](_0x2403df)[_0x282e35(0x102)](()=>{}),this['handleDirectMessageRelay'](_0x2403df)[_0x282e35(0x102)](()=>{}));},this[_0x22854e(0x11d)]=new Map();}};