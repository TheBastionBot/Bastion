const a160_0x61cd=['handleKarma','../utils/embeds','roles','tag','set','language','setTimeout','return\x20/\x22\x20+\x20this\x20+\x20\x22/','relayDirectMessages','handleTriggers','humanMessage','json','experience','cache','findOne','\x20Trigger','responseMessage','locale','IRIS','includes','toLowerCase','Constants','catch','@bastion/tesseract','map','handleGamification','replaceMessageVariables','get','document','add','save','from','levelUp','handleInstantResponses','keys','find','MAX_LEVEL','floor','COLORS','updateMany','credit','responseReaction','response','mentions','success','has','client','trigger','channel','../models/Config','content','users','createDM','length','random','reply','../utils/variables','getString','info','owner','smallestNeighbor','exports','../models/TextChannel','apply','member','size','handleVotingChannels','gamification','getConstant','guild','handleLevelRoles','react','level','filter','send','displayAvatarURL','recentUsers','author','error','handleDirectMessageRelay','constructor','../models/Trigger','multiplier','user','stringify','premiumSinceTimestamp','../models/Member','_id','default','Logger','thanks','test','parse','../utils/gamification','Level-up\x20Reward','findById','indexOf','DEFAUL_CURRENCY_REWARD_MULTIPLIER','../utils/omnic','../utils/numbers','remove','replace','../utils/emojis','status','thank\x20you'];(function(_0x22a6eb,_0x61cde9){const _0x54f24f=function(_0x34efeb){while(--_0x34efeb){_0x22a6eb['push'](_0x22a6eb['shift']());}},_0x2edec4=function(){const _0x5c2fb3={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x578a83,_0x1ca83b,_0x31a4a7,_0x22dcc6){_0x22dcc6=_0x22dcc6||{};let _0xa6b631=_0x1ca83b+'='+_0x31a4a7,_0x183e3f=0x0;for(let _0xbf14c0=0x0,_0x52a074=_0x578a83['length'];_0xbf14c0<_0x52a074;_0xbf14c0++){const _0x6c36c4=_0x578a83[_0xbf14c0];_0xa6b631+=';\x20'+_0x6c36c4;const _0x2abcc6=_0x578a83[_0x6c36c4];_0x578a83['push'](_0x2abcc6),_0x52a074=_0x578a83['length'],_0x2abcc6!==!![]&&(_0xa6b631+='='+_0x2abcc6);}_0x22dcc6['cookie']=_0xa6b631;},'removeCookie':function(){return'dev';},'getCookie':function(_0x4fb2c9,_0x5ee014){_0x4fb2c9=_0x4fb2c9||function(_0xdd0eda){return _0xdd0eda;};const _0x18059e=_0x4fb2c9(new RegExp('(?:^|;\x20)'+_0x5ee014['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x35d05e=function(_0x33df36,_0x2060d1){_0x33df36(++_0x2060d1);};return _0x35d05e(_0x54f24f,_0x61cde9),_0x18059e?decodeURIComponent(_0x18059e[0x1]):undefined;}},_0x304843=function(){const _0x2307c2=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2307c2['test'](_0x5c2fb3['removeCookie']['toString']());};_0x5c2fb3['updateCookie']=_0x304843;let _0x97ff9b='';const _0x11528b=_0x5c2fb3['updateCookie']();if(!_0x11528b)_0x5c2fb3['setCookie'](['*'],'counter',0x1);else _0x11528b?_0x97ff9b=_0x5c2fb3['getCookie'](null,'counter'):_0x5c2fb3['removeCookie']();};_0x2edec4();}(a160_0x61cd,0xdc));const a160_0x54f2=function(_0x22a6eb,_0x61cde9){_0x22a6eb=_0x22a6eb-0x0;let _0x54f24f=a160_0x61cd[_0x22a6eb];return _0x54f24f;};const _0x12dfc2=a160_0x54f2,a160_0x5c2fb3=function(){let _0x97ff9b=!![];return function(_0x11528b,_0x578a83){const _0x1ca83b=_0x97ff9b?function(){const _0x38d4f3=a160_0x54f2;if(_0x578a83){const _0x31a4a7=_0x578a83[_0x38d4f3('0x35')](_0x11528b,arguments);return _0x578a83=null,_0x31a4a7;}}:function(){};return _0x97ff9b=![],_0x1ca83b;};}(),a160_0x34efeb=a160_0x5c2fb3(this,function(){const _0x22dcc6=function(){const _0x33dfc6=a160_0x54f2,_0xa6b631=_0x22dcc6[_0x33dfc6('0x46')](_0x33dfc6('0x66'))()[_0x33dfc6('0x46')]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0xa6b631[_0x33dfc6('0x51')](a160_0x34efeb);};return _0x22dcc6();});a160_0x34efeb();'use strict';const tesseract_1=require(_0x12dfc2('0xd')),discord_js_1=require('discord.js'),embeds=require(_0x12dfc2('0x60')),emojis=require(_0x12dfc2('0x5c')),gamification=require(_0x12dfc2('0x53')),numbers=require(_0x12dfc2('0x59')),omnic=require(_0x12dfc2('0x58')),variables=require(_0x12dfc2('0x2e')),Config_1=require(_0x12dfc2('0x27')),Member_1=require(_0x12dfc2('0x4c')),Role_1=require('../models/Role'),TextChannel_1=require(_0x12dfc2('0x34')),Trigger_1=require(_0x12dfc2('0x47'));module[_0x12dfc2('0x33')]=class HumanMessageEvent extends tesseract_1['ModuleManagerEvent']{constructor(){const _0x582e7e=_0x12dfc2;super(_0x582e7e('0x0')),this['handleLevelRoles']=async(_0x183e3f,_0xbf14c0)=>{const _0x475743=_0x582e7e,_0x52a074=await Role_1[_0x475743('0x4e')][_0x475743('0x19')]({'guild':_0x183e3f[_0x475743('0x3b')]['id'],'level':{'$exists':!![],'$ne':null}});if(!_0x52a074||!_0x52a074[_0x475743('0x2b')])return;const _0x6c36c4=numbers[_0x475743('0x32')](_0xbf14c0,_0x52a074[_0x475743('0xe')](_0x5ee014=>_0x5ee014[_0x475743('0x3e')])),_0x2abcc6=_0x52a074[_0x475743('0x3f')](_0x18059e=>_0x18059e[_0x475743('0x3e')]!==_0x6c36c4&&_0x183e3f[_0x475743('0x3b')][_0x475743('0x61')][_0x475743('0x3')][_0x475743('0x23')](_0x18059e[_0x475743('0x4d')])),_0x4fb2c9=_0x52a074[_0x475743('0x3f')](_0x35d05e=>_0x35d05e[_0x475743('0x3e')]===_0x6c36c4&&_0x183e3f[_0x475743('0x3b')][_0x475743('0x61')][_0x475743('0x3')]['has'](_0x35d05e[_0x475743('0x4d')]));_0x4fb2c9[_0x475743('0x2b')]&&(await _0x183e3f[_0x475743('0x36')][_0x475743('0x61')][_0x475743('0x13')](_0x4fb2c9['map'](_0xdd0eda=>_0xdd0eda[_0x475743('0x4d')])),await _0x183e3f[_0x475743('0x36')][_0x475743('0x61')][_0x475743('0x5a')](_0x2abcc6[_0x475743('0xe')](_0x33df36=>_0x33df36[_0x475743('0x4d')])));},this['handleGamification']=async _0x2060d1=>{const _0x6487ae=_0x582e7e,_0x2307c2=this[_0x6487ae('0x42')]['get'](_0x2060d1[_0x6487ae('0x3b')]['id'])||[];if(_0x2307c2[_0x6487ae('0x9')](_0x2060d1[_0x6487ae('0x43')]['id']))return;const _0x4f6776=_0x2060d1['client'],_0x10d920=_0x2060d1[_0x6487ae('0x3b')],_0x4bf7db=_0x2060d1[_0x6487ae('0x36')];if(!_0x10d920['document'][_0x6487ae('0x39')]||!_0x10d920[_0x6487ae('0x12')][_0x6487ae('0x39')]['enabled'])return;if(_0x4bf7db['document']['level']>=gamification[_0x6487ae('0x1a')]||_0x4bf7db[_0x6487ae('0x12')][_0x6487ae('0x2')]>=gamification['MAX_EXPERIENCE'](_0x10d920[_0x6487ae('0x12')][_0x6487ae('0x39')][_0x6487ae('0x48')]))return;_0x4bf7db[_0x6487ae('0x12')][_0x6487ae('0x2')]=_0x4bf7db[_0x6487ae('0x4b')]?_0x4bf7db[_0x6487ae('0x12')][_0x6487ae('0x2')]+0x2:_0x4bf7db['document'][_0x6487ae('0x2')]+0x1;const _0x56be4f=gamification['computeLevel'](_0x4bf7db[_0x6487ae('0x12')][_0x6487ae('0x2')],_0x10d920[_0x6487ae('0x12')][_0x6487ae('0x39')][_0x6487ae('0x48')]);_0x56be4f>_0x4bf7db[_0x6487ae('0x12')][_0x6487ae('0x3e')]&&(await _0x4bf7db[_0x6487ae('0x1e')](_0x56be4f*gamification[_0x6487ae('0x57')],_0x6487ae('0x54'),_0x4bf7db[_0x6487ae('0x12')]),_0x10d920['document'][_0x6487ae('0x39')]['messages']&&_0x2060d1[_0x6487ae('0x26')]['send']({'embed':{'color':tesseract_1[_0x6487ae('0xb')][_0x6487ae('0x1c')]['IRIS'],'fields':[{'name':'LEVELED\x20UP!','value':_0x4f6776[_0x6487ae('0x7')][_0x6487ae('0x2f')](_0x10d920[_0x6487ae('0x12')][_0x6487ae('0x64')],_0x6487ae('0x30'),_0x6487ae('0x16'),_0x2060d1['author'][_0x6487ae('0x62')],_0x56be4f)}]}})[_0x6487ae('0xc')](()=>{}),this[_0x6487ae('0x3c')](_0x2060d1,_0x4bf7db['document'][_0x6487ae('0x3e')])[_0x6487ae('0xc')](tesseract_1[_0x6487ae('0x4f')][_0x6487ae('0x44')])),_0x4bf7db['document'][_0x6487ae('0x3e')]=_0x56be4f,await _0x4bf7db['document'][_0x6487ae('0x14')](),_0x2307c2['push'](_0x2060d1[_0x6487ae('0x43')]['id']),this[_0x6487ae('0x42')][_0x6487ae('0x63')](_0x2060d1[_0x6487ae('0x3b')]['id'],_0x2307c2),_0x2060d1[_0x6487ae('0x24')][_0x6487ae('0x65')](()=>{const _0x1ea395=_0x6487ae,_0xc37933=this[_0x1ea395('0x42')][_0x1ea395('0x11')](_0x2060d1[_0x1ea395('0x3b')]['id']);_0xc37933['splice'](_0xc37933[_0x1ea395('0x56')](_0x2060d1[_0x1ea395('0x43')]['id']),0x1),this[_0x1ea395('0x42')][_0x1ea395('0x63')](_0x2060d1[_0x1ea395('0x3b')]['id'],_0xc37933);},0x32c8);},this[_0x582e7e('0x68')]=async _0x505ab4=>{const _0x1d3dd8=_0x582e7e;if(!_0x505ab4[_0x1d3dd8('0x28')])return;const _0x59d275=await Trigger_1[_0x1d3dd8('0x4e')]['find']({'guild':_0x505ab4[_0x1d3dd8('0x3b')]['id']}),_0x5a7b9c=[],_0x23e53c=[];for(const _0x4e3a01 of _0x59d275){const _0x2dafee=new RegExp(_0x4e3a01[_0x1d3dd8('0x25')][_0x1d3dd8('0x5b')](/\?/g,'.')['replace'](/\*+/g,'.*'),'ig');if(!_0x2dafee[_0x1d3dd8('0x51')](_0x505ab4['content']))continue;_0x4e3a01[_0x1d3dd8('0x6')]&&_0x5a7b9c['push'](_0x4e3a01[_0x1d3dd8('0x6')]);if(_0x4e3a01['responseReaction']){const _0x1f7532=emojis['parseEmoji'](_0x4e3a01[_0x1d3dd8('0x1f')]);_0x1f7532&&_0x23e53c['push'](_0x1f7532['reaction']);}}_0x5a7b9c['length']&&_0x505ab4[_0x1d3dd8('0x26')]['send']({'embed':{...embeds['generateEmbed'](JSON[_0x1d3dd8('0x52')](variables[_0x1d3dd8('0x10')](JSON[_0x1d3dd8('0x4a')](_0x5a7b9c[Math[_0x1d3dd8('0x1b')](Math[_0x1d3dd8('0x2c')]()*_0x5a7b9c[_0x1d3dd8('0x2b')])]),_0x505ab4))),'footer':{'text':_0x505ab4[_0x1d3dd8('0x24')]['locale'][_0x1d3dd8('0x3a')]('bastion.name')+_0x1d3dd8('0x5')}}})['catch'](tesseract_1['Logger'][_0x1d3dd8('0x44')]),_0x23e53c[_0x1d3dd8('0x2b')]&&_0x505ab4['react'](_0x23e53c[Math[_0x1d3dd8('0x1b')](Math[_0x1d3dd8('0x2c')]()*_0x23e53c['length'])])[_0x1d3dd8('0xc')](tesseract_1['Logger']['error']);},this[_0x582e7e('0x38')]=async _0x4f2167=>{const _0x41be7e=_0x582e7e,_0x2a355e=await TextChannel_1['default'][_0x41be7e('0x4')]({'_id':_0x4f2167[_0x41be7e('0x26')]['id'],'voting':!![]});if(!_0x2a355e)return;_0x4f2167[_0x41be7e('0x3d')]('ðŸ‘')[_0x41be7e('0xc')](()=>{}),_0x4f2167[_0x41be7e('0x3d')]('ðŸ‘Ž')['catch'](()=>{});},this[_0x582e7e('0x5f')]=async _0x31d80f=>{const _0xf322c6=_0x582e7e;if(!_0x31d80f['content'])return;if((_0x31d80f['content']['toLowerCase']()[_0xf322c6('0x9')](_0xf322c6('0x50'))||_0x31d80f[_0xf322c6('0x28')][_0xf322c6('0xa')]()[_0xf322c6('0x9')](_0xf322c6('0x5e')))&&_0x31d80f[_0xf322c6('0x21')][_0xf322c6('0x29')]&&_0x31d80f[_0xf322c6('0x21')]['users'][_0xf322c6('0x37')]){const _0x264d5f=Array[_0xf322c6('0x15')](_0x31d80f[_0xf322c6('0x21')][_0xf322c6('0x29')][_0xf322c6('0x18')]())[_0xf322c6('0x3f')](_0xe1b949=>_0xe1b949!==_0x31d80f[_0xf322c6('0x36')]['id']);await Member_1['default'][_0xf322c6('0x1d')]({'user':{'$in':_0x264d5f},'guild':_0x31d80f[_0xf322c6('0x3b')]['id']},{'$inc':{'karma':0x1}}),_0x31d80f[_0xf322c6('0x3d')]('ðŸ†™')[_0xf322c6('0xc')](()=>{});}},this[_0x582e7e('0x17')]=async _0x2908e3=>{const _0x1733cb=_0x582e7e;if(!_0x2908e3[_0x1733cb('0x28')])return;const _0x5d2a96=await omnic['makeRequest']('/chat/instant?message='+encodeURIComponent(_0x2908e3[_0x1733cb('0x28')]))['then'](_0x505fdc=>_0x505fdc[_0x1733cb('0x1')]());if(_0x5d2a96[_0x1733cb('0x5d')]!==_0x1733cb('0x22'))return;const _0x6c10d8=_0x5d2a96[_0x1733cb('0x20')][_0x1733cb('0x2d')]instanceof Array?_0x5d2a96[_0x1733cb('0x20')][_0x1733cb('0x2d')]:[_0x5d2a96['response'][_0x1733cb('0x2d')]];for(const _0x154dda of _0x6c10d8){await _0x2908e3[_0x1733cb('0x26')][_0x1733cb('0x40')](_0x154dda)[_0x1733cb('0xc')](()=>{});}},this[_0x582e7e('0x45')]=async _0x547f13=>{const _0x5880e4=_0x582e7e,_0x34e981=await Config_1[_0x5880e4('0x4e')][_0x5880e4('0x55')](_0x547f13[_0x5880e4('0x24')][_0x5880e4('0x49')]['id']);if(_0x34e981[_0x5880e4('0x67')]&&_0x547f13['content']){const _0x1b2543=await _0x547f13[_0x5880e4('0x24')]['fetchApplication'](),_0x599e40=_0x1b2543[_0x5880e4('0x31')]instanceof discord_js_1['Team']?_0x1b2543[_0x5880e4('0x31')]['owner'][_0x5880e4('0x49')]:_0x1b2543['owner'];if(_0x547f13[_0x5880e4('0x43')]['id']===_0x599e40['id'])return;const _0x2a5754=await _0x599e40[_0x5880e4('0x2a')]();await _0x2a5754[_0x5880e4('0x40')]({'embed':{'color':tesseract_1[_0x5880e4('0xb')][_0x5880e4('0x1c')][_0x5880e4('0x8')],'author':{'name':_0x547f13['author']['tag'],'iconURL':_0x547f13[_0x5880e4('0x43')][_0x5880e4('0x41')]({'dynamic':!![],'size':0x40})},'description':_0x547f13[_0x5880e4('0x28')],'footer':{'text':_0x547f13['author']['id']}}});}},this['exec']=async _0x300891=>{const _0x175be7=_0x582e7e;_0x300891[_0x175be7('0x3b')]?(this[_0x175be7('0xf')](_0x300891)[_0x175be7('0xc')](()=>{}),this[_0x175be7('0x68')](_0x300891)[_0x175be7('0xc')](()=>{}),this[_0x175be7('0x5f')](_0x300891)['catch'](tesseract_1['Logger'][_0x175be7('0x44')]),this[_0x175be7('0x38')](_0x300891)['catch'](()=>{})):(this['handleInstantResponses'](_0x300891)[_0x175be7('0xc')](()=>{}),this[_0x175be7('0x45')](_0x300891)[_0x175be7('0xc')](()=>{}));},this[_0x582e7e('0x42')]=new Map();}};